# Реферальная система

## О проекте:

### Проект выполнен на Python  с использованием Django REST Framework и PostgreSQL.

Проект представляет собой реферальную систему. В проекте реализованы функции:  
- Регистрация и авьторизация пользователей по номеру телефона с имитацией подтверждения номера по СМС и присвоением инвайт-кода.  
- Просмотр личного профиля с информацией о собственном инвайт-коде и номерах телефонов пользователей, активировавших инвайт-код текущего пользователя. 
- Возможность активации чужого инвайт-кода в личном профиле пользователя.

___

## Установка и запуск

Для запуска понадобится:

1. Скопировать файлы проекта из репозитория

2. Установить все необходимые библиотеки командой:

```
 pip install -r requirements.txt
```

3. Заменить (если потребуется) настройки подключения к базе данных в файле **.env** в директории **project**  


4. Перейти в директорию проекта командой:

```
 cd project
```

5. Создать миграции командой:

```
 python manage.py makemigrations
```

6. Запустить локальный сервер коммандой:

```
 python manage.py migrate
```


7. Запустить локальный сервер коммандой:

```
 python manage.py runserver
```

Графический интерфейс будет доступен по адресу [http://127.0.0.1:8000/user/signup](http://127.0.0.1:8000/user/signup)

Эндпоинты API по адресу http://127.0.0.1:8000/swagger/
___
## Описание функциональности API:

*Заросы и ответы осуществляются в формате JSON*

### Документация API представлена по адресу  [http://127.0.0.1:8000/redoc/](http://127.0.0.1:8000/redoc/)

### 1. Запрос авторизации по номеру телефона:

```
POST /api/user_login
```

Тело запроса: `{"phone_number":  "Номер телефона"}`

Тело положительного ответа: `{"authentication_code": "4-х значный код подтверждения"}`  
Тело положительного отридцательного ответа: `{"message": "phone number cannot be empty"}`

### 2.  Запрос подтверждения:

```
POST /api/user_auth
```

Тело запроса: `{"authentication_code": "4-х значный код подтверждения"}`

Тело положительного ответа: `{"message": "Accepted"}`
Тело отридцательного ответа: `{"message": "Wrong authentication code"}`

### 3. Запрос личного профиля:

```
GET /api/user_profile
```

Тело положительного ответа: 
```json
{
"user_profile": 
    {
        "phone_number": "Авторизованный номер телефона",
        "own_invite_code": "Собственный 6-значный инвайт-код",
        "activated_invite_code": "Активированый 6-значный инвайт-код (либо пустое поле, если код ещё не активирован)",
        "activated_users": [
            "список номеров телефонов других пользователей, которые активировали код текущего пользователя"
        ]
    }
}
```

Тело отридцательного ответа (в случае, если пользователь не прошел авторизацию): 
`{"detail": "Authentication credentials were not provided."}`

### 4. Запрос на активацию инвайт кода:

```
POST /api/user_profile
```

Тело запроса: `{"invite_code":"Чужой 6-значный инвайт-код"}`

Тело положительного ответа: `{"message": "Invite code successfully activated"}`

Тело отридцательного ответа (попытка активации собственного кода): `{"message": "Own invite code cannot be activated"}`  
Тело отридцательного ответа (попытка повторной активации кода): `{"message": "Invite code {активный код} already activated"}`  
Тело отридцательного ответа (в случае, если пользователь не прошел авторизацию):  `{"detail": "Authentication credentials were not provided."}`  

___